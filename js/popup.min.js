const popupMessageUs=document.querySelector(".modal-message"),popupOpenButton=document.querySelector(".address__button"),popupCloseButton=popupMessageUs.querySelector(".modal-message__close-button"),popupForm=popupMessageUs.querySelector(".modal-message__form"),popupUserName=popupMessageUs.querySelector("[name=modal-username]"),popupUserEmail=popupMessageUs.querySelector("[name=modal-email]"),popupTextareaMessage=popupMessageUs.querySelector("[name=modal-message]");let isPopupStorageSupport=!0,popupNameStorage="",popupEmailStorage="";try{popupNameStorage=localStorage.getItem("user-name"),popupEmailStorage=localStorage.getItem("user-email")}catch(e){isPopupStorageSupport=!1}const alertErrMessage=function(e){alert(e)},closePopupHandler=function(e){e.classList.add("modal-message_close"),setTimeout(function(){e.classList.remove("modal-message_close")},600),setTimeout(function(){e.classList.remove("modal-message_show")},500)};popupOpenButton.addEventListener("click",function(e){e.preventDefault(),popupMessageUs.classList.add("modal-message_show"),popupNameStorage?(popupUserName.value=popupNameStorage,popupUserEmail.focus(),popupEmailStorage&&(popupUserEmail.value=popupEmailStorage,popupTextareaMessage.focus())):popupUserName.focus()}),popupForm.addEventListener("submit",function(e){popupUserName.value&&popupUserEmail.value&&popupTextareaMessage.value?isPopupStorageSupport&&(localStorage.setItem("user-name",popupUserName.value),localStorage.setItem("user-email",popupUserEmail.value)):(e.preventDefault(),popupMessageUs.classList.remove("modal-message_error"),popupMessageUs.offsetWidth=popupMessageUs.offsetWidth,popupMessageUs.classList.add("modal-message_error"),setTimeout(alertErrMessage,300,"Вы не заполнили обязательные поля!\nПеред отправкой сообщения, пожалуйста, заполните все поля."))}),popupCloseButton.addEventListener("click",function(e){e.preventDefault(),closePopupHandler(popupMessageUs),popupMessageUs.classList.remove("modal-message_error")}),window.addEventListener("keydown",function(e){"Escape"!==e.key&&"Esc"!==e.key||popupMessageUs.classList.contains("modal-message_show")&&(e.preventDefault(),closePopupHandler(popupMessageUs),popupMessageUs.classList.remove("modal-message_error"))});
